import{_ as B,o as d,c as g,a as m,d as P,r as b,b as R,u as k,t as C,e as l,w as n,f as y,i as D,F as N,g as c,h as I,j as x,s as J,k as S}from"./index-C_jJfI7v.js";const q={name:"PreCode",props:{orgin:Object},methods:{preLineStartEnd(){const u=this.orgin.source.split(`
`),f=u.length-1,_=this.orgin.line-3>=0?this.orgin.line-3:0,v=_+5>=f?f:_+5,r=this.orgin.line;let a=[];for(var s=_;s<=v;s++){const V=s+1+".    "+this.encodeHTML(u[s]);a.push(`<div class='code-line ${s+1==r?"heightlight":""}'>${V}</div>`)}return a.join("")},encodeHTML(u){return!u||u.length==0?"":u.replace(/&/g,"&#38;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;")}}},z={class:"pre_code"},A={class:"errdetail"},G=["innerHTML"];function K(u,f,_,v,r,a){return d(),g("div",z,[m("div",A,[m("pre",{class:"errCode",innerHTML:a.preLineStartEnd()},null,8,G)])])}const Q=B(q,[["render",K]]),W={key:0},X={key:1},Y=m("i",{class:"el-icon-upload"},null,-1),Z=m("div",{class:"el-upload__text"},[x("将文件拖到此处，或"),m("em",null,"点击上传")],-1),te=P({__name:"HomeView",setup(u){const f=b("1"),_=b("1");let v=b(!1),r=b(!1),a=b(null),s={line:0,cloum:0,index:0};R(()=>{try{let e=localStorage.getItem("jsErrorList");e&&(v.value=!0,a.value=JSON.parse(e),console.log(a.value))}catch(e){console.log(e)}});const V=e=>e.substring(0,100)+"...",T=(e,t)=>{s={line:e.lineNumber,cloum:e.columnNumber,index:t},r.value=!0},$=async e=>{if(e.name.substring(e.name.lastIndexOf(".")+1)!=="map"){alert("请上传.js.map 文件！");return}const t=new FileReader;return t.readAsText(e,"UTF-8"),t.onload=async p=>{const i=await j(p.target.result,s.line,s.cloum);a.value.stack_frames[s.index].origin=i,r.value=!1},!1},j=async(e,t,p)=>{try{const i=await new J.SourceMapConsumer(JSON.parse(e)),h=i.originalPositionFor({line:t,column:p});return{source:i.sourceContentFor(h.source),column:h.column,line:h.line}}catch(i){return alert("未能解析出sourceMap！"),console.log(i),null}},F=e=>{e()};return(e,t)=>{const p=c("el-col"),i=c("el-button"),h=c("el-row"),L=c("el-collapse-item"),U=c("el-collapse"),E=c("el-upload"),M=c("el-tab-pane"),H=c("el-tabs"),O=c("el-dialog");return d(),g(N,null,[k(v)?(d(),g("div",W,[m("pre",null,"      "+C(k(a).stack)+`
    `,1),l(U,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=o=>f.value=o),accordion:""},{default:n(()=>[(d(!0),g(N,null,I(k(a).stack_frames,(o,w)=>(d(),S(L,{key:w,title:V(o.source),name:w},{default:n(()=>[l(h,{gutter:20},{default:n(()=>[l(p,{span:20},{default:n(()=>[m("div",null,C(o.fileName),1)]),_:2},1024),l(p,{span:4},{default:n(()=>[l(i,{size:"small",type:"primary",onClick:ee=>T(o,w)},{default:n(()=>[x("映射源码")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),l(p,{span:20},{default:n(()=>[o.origin?(d(),g(N,{key:0},[o.origin?(d(),S(Q,{key:0,orgin:o.origin},null,8,["orgin"])):y("",!0)],64)):y("",!0),o.origin?y("",!0):(d(),g("div",X,C(o.fileName),1))]),_:2},1024)]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])])):y("",!0),l(O,{title:"sourceMap映射",modelValue:k(r),"onUpdate:modelValue":t[2]||(t[2]=o=>D(r)?r.value=o:r=o),width:"500px","before-close":F},{default:n(()=>[l(H,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=o=>_.value=o)},{default:n(()=>[l(M,{label:"本地上传",name:"local"},{default:n(()=>[l(E,{style:{width:"100%"},class:"upload-demo",drag:"",action:"","before-upload":$},{default:n(()=>[Y,Z]),_:1})]),_:1}),l(M,{label:"远程加载",name:"request"},{default:n(()=>[x("远程加载")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64)}}});export{te as default};
//# sourceMappingURL=HomeView-DmOXJJwC.js.map

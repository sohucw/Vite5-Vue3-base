import{_ as B,o as d,c as g,a as m,d as P,r as b,b as R,e as D,u as k,t as C,f as l,w as n,g as y,i as I,F as N,h as c,j as J,k as x,s as q,l as S}from"./index-CjisjT1A.js";const z={name:"PreCode",props:{orgin:Object},methods:{preLineStartEnd(){const u=this.orgin.source.split(`
`),f=u.length-1,_=this.orgin.line-3>=0?this.orgin.line-3:0,h=_+5>=f?f:_+5,r=this.orgin.line;let a=[];for(var s=_;s<=h;s++){const V=s+1+".    "+this.encodeHTML(u[s]);a.push(`<div class='code-line ${s+1==r?"heightlight":""}'>${V}</div>`)}return a.join("")},encodeHTML(u){return!u||u.length==0?"":u.replace(/&/g,"&#38;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;")}}},A={class:"pre_code"},G={class:"errdetail"},K=["innerHTML"];function Q(u,f,_,h,r,a){return d(),g("div",A,[m("div",G,[m("pre",{class:"errCode",innerHTML:a.preLineStartEnd()},null,8,K)])])}const W=B(z,[["render",Q]]),X={key:0},Y={key:1},Z=m("i",{class:"el-icon-upload"},null,-1),ee=m("div",{class:"el-upload__text"},[x("将文件拖到此处，或"),m("em",null,"点击上传")],-1),ne=P({__name:"HomeView",setup(u){const f=b("1"),_=b("1");let h=b(!1),r=b(!1),a=R(null),s={line:0,cloum:0,index:0};D(()=>{try{let e=localStorage.getItem("jsErrorList");e&&(h.value=!0,a=JSON.parse(e),console.log(a))}catch(e){console.log(e)}});const V=e=>e.substring(0,100)+"...",T=(e,t)=>{s={line:e.lineNumber,cloum:e.columnNumber,index:t},r.value=!0},$=async e=>{if(e.name.substring(e.name.lastIndexOf(".")+1)!=="map"){alert("请上传.js.map 文件！");return}const t=new FileReader;return t.readAsText(e,"UTF-8"),t.onload=async p=>{const i=await j(p.target.result,s.line,s.cloum);a.stack_frames[s.index].origin=i,r.value=!1},!1},j=async(e,t,p)=>{try{const i=await new q.SourceMapConsumer(JSON.parse(e)),v=i.originalPositionFor({line:t,column:p});return{source:i.sourceContentFor(v.source),column:v.column,line:v.line}}catch(i){return alert("未能解析出sourceMap！"),console.log(i),null}},F=e=>{e()};return(e,t)=>{const p=c("el-col"),i=c("el-button"),v=c("el-row"),L=c("el-collapse-item"),U=c("el-collapse"),E=c("el-upload"),M=c("el-tab-pane"),H=c("el-tabs"),O=c("el-dialog");return d(),g(N,null,[k(h)?(d(),g("div",X,[m("pre",null,"      "+C(k(a).stack)+`
    `,1),l(U,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=o=>f.value=o),accordion:""},{default:n(()=>[(d(!0),g(N,null,J(k(a).stack_frames,(o,w)=>(d(),S(L,{key:w,title:V(o.source),name:w},{default:n(()=>[l(v,{gutter:20},{default:n(()=>[l(p,{span:20},{default:n(()=>[m("div",null,C(o.fileName),1)]),_:2},1024),l(p,{span:4},{default:n(()=>[l(i,{size:"small",type:"primary",onClick:oe=>T(o,w)},{default:n(()=>[x("映射源码")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),l(p,{span:20},{default:n(()=>[o.origin?(d(),g(N,{key:0},[o.origin?(d(),S(W,{key:0,orgin:o.origin},null,8,["orgin"])):y("",!0)],64)):y("",!0),o.origin?y("",!0):(d(),g("div",Y,C(o.fileName),1))]),_:2},1024)]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])])):y("",!0),l(O,{title:"sourceMap映射",modelValue:k(r),"onUpdate:modelValue":t[2]||(t[2]=o=>I(r)?r.value=o:r=o),width:"500px","before-close":F},{default:n(()=>[l(H,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=o=>_.value=o)},{default:n(()=>[l(M,{label:"本地上传",name:"local"},{default:n(()=>[l(E,{style:{width:"100%"},class:"upload-demo",drag:"",action:"","before-upload":$},{default:n(()=>[Z,ee]),_:1})]),_:1}),l(M,{label:"远程加载",name:"request"},{default:n(()=>[x("远程加载")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64)}}});export{ne as default};
//# sourceMappingURL=HomeView-BPsG_w5i.js.map
